<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>relax and type</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #e5e7eb;
      background-color: #020817;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    /* Video background */
    #bgvid {
      position: fixed;
      top: 0;
      left: 0;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      z-index: -1;
      object-fit: cover;
      filter: brightness(0.35) blur(1px);
    }

    .container {
      background: rgba(2, 8, 23, 0.9);
      backdrop-filter: blur(8px);
      border-radius: 16px;
      padding: 20px 20px 10px;
      max-width: 960px;
      width: 100%;
      border: 1px solid rgba(15, 23, 42, 0.9);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.75);
    }

    h1 {
      margin: 0 0 4px;
      font-size: 24px;
      color: #f9fafb;
      letter-spacing: 0.06em;
    }

    .sub {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 10px;
    }

    #prompt {
      font-size: 17px;
      line-height: 1.7;
      padding: 14px 12px;
      background-color: rgba(2, 6, 23, 0.98);
      border-radius: 10px;
      border: 1px solid #111827;
      min-height: 90px;
      margin-bottom: 8px;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    #prompt span.correct {
      color: #22c55e;
    }

    #prompt span.incorrect {
      color: #ef4444;
      text-decoration: underline;
    }

    #input {
      width: 100%;
      height: 130px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #111827;
      background-color: #020817;
      color: #e5e7eb;
      font-size: 15px;
      resize: none;
      outline: none;
      margin-top: 2px;
    }

    #input:disabled {
      opacity: 0.55;
    }

    .stats {
      margin-top: 8px;
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      font-size: 12px;
      color: #9ca3af;
    }

    .stat-block {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .stat-label {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #6b7280;
    }

    .stat-value {
      font-size: 17px;
      color: #e5e7eb;
      font-weight: 600;
    }

    .buttons {
      margin-top: 10px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    button {
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      font-size: 12px;
      cursor: pointer;
      background-color: #2563eb;
      color: #f9fafb;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      transition: all 0.12s ease;
    }

    button.secondary {
      background-color: #111827;
      color: #e5e7eb;
    }

    button:hover {
      background-color: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(37, 99, 235, 0.3);
    }

    button.secondary:hover {
      background-color: #1f2937;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.55);
    }

    .audio-label {
      margin-top: 4px;
      font-size: 9px;
      color: #6b7280;
    }

    .music-player {
      margin-top: 6px;
      font-size: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      color: #9ca3af;
    }

    .mp-label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 8px;
      color: #6b7280;
    }

    .mp-track {
      font-size: 11px;
      color: #e5e7eb;
    }

    .mp-btn {
      padding: 3px 10px;
      border-radius: 999px;
      border: none;
      background-color: #111827;
      color: #e5e7eb;
      font-size: 9px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: all 0.12s ease;
    }

    .mp-btn:hover {
      background-color: #1f2937;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
      transform: translateY(-0.5px);
    }
  </style>
</head>
<body>

  <!-- Live video background -->
  <video autoplay muted loop id="bgvid">
    <source src="waterdrops.mp4" type="video/mp4">
  </video>

  <div class="container">
    <h1>relax and type</h1>
    <div class="sub">
      Type the full line. Letters turn green when correct, red when wrong. No autocorrect, no spellcheck, no training wheels.
    </div>

    <div id="prompt"></div>

    <textarea
      id="input"
      placeholder="Start typing here..."
      spellcheck="false"
      autocorrect="off"
      autocomplete="off"
      autocapitalize="off"
    ></textarea>

    <div class="stats">
      <div class="stat-block">
        <span class="stat-label">WPM</span>
        <span class="stat-value" id="wpm">-</span>
      </div>
      <div class="stat-block">
        <span class="stat-label">Accuracy</span>
        <span class="stat-value" id="accuracy">-</span>
      </div>
      <div class="stat-block">
        <span class="stat-label">Errors</span>
        <span class="stat-value" id="errors">-</span>
      </div>
      <div class="stat-block">
        <span class="stat-label">Characters</span>
        <span class="stat-value" id="chars">-</span>
      </div>
    </div>

    <div class="buttons">
      <button id="newPromptBtn">New Prompt</button>
      <button class="secondary" id="restartBtn">Restart Same Prompt</button>
    </div>

    <div class="music-player">
      <span class="mp-label">Now Playing</span>
      <span class="mp-track" id="nowPlaying">-</span>
      <button class="mp-btn" id="playPauseBtn">Pause</button>
      <button class="mp-btn" id="nextTrackBtn">Next Track</button>
    </div>

    <div class="audio-label">
      Uses lofi1.mp3 - lofi10.mp3 in this folder. Click once if your browser blocks autoplay.
    </div>
  </div>

  <script>
    // ----------------- PROMPTS -----------------
    const typingPrompts = [
      "You step into the room and everyone goes quiet, not because they were waiting for you, but because they just realized you are not the same person who left.",
      "The city hums, neon buzzing in puddles on cracked concrete, and for a second you understand that no one is coming to save you, but you are strangely fine with that.",
      "He laughed like he had nothing to lose, which was unsettling, because people with nothing to lose are the ones who stop pretending to be small.",
      "She did not raise her voice; she simply decided she was done apologizing for existing, and the entire night shifted around her like gravity had been rewired.",
      "You tell yourself it is not the right time, but the truth is you are waiting for courage to walk in uninvited and drag you forward by the collar.",
      "The door did not open to luck; it opened to work, doubt, sweat, and ten thousand quiet decisions that no one would ever clap for.",
      "He walked away from the noise, not because he was weak, but because he finally understood that peace is louder on the inside than applause on the outside.",
      "In a cheap mirror with harsh lighting, she stared at the person she used to blame and finally said, we are done being the villain in our own story.",
      "The plan was never perfect, it was just real, and that made it more dangerous than every pretty fantasy that died in the group chat.",
      "You grip the steering wheel at a red light and realize the scariest part is not that life is short, but that it is lived mostly on autopilot.",
      "He lit the last cigarette he promised not to touch and admitted the truth, that staying the same had become more painful than changing.",
      "There is a version of you that stopped negotiating with excuses, and that version is staring at you like, are we finished wasting time yet.",
      "The clock on the wall does not care about feelings, fear, or backstory; it only measures whether you moved or stayed still.",
      "She laughed in the middle of the argument, not because it was funny, but because she recognized the pattern and refused to play her old role again.",
      "Every late night, every early morning, every boring repetition quietly turned into something people would later call an overnight success.",
      "He was not fearless; he was exhausted from being owned by fear, which turned out to be better fuel than confidence.",
      "For once, nobody had a speech or a quote; there was just the work in front of you and the choice to finally do it.",
      "You are sitting in the same room, with the same people, having the same conversations, wondering why nothing feels different.",
      "She stopped waiting for closure from people who never gave clarity and built a life where their silence no longer had jurisdiction.",
      "The world did not hand him a purpose; he stitched it together out of ordinary days, stubborn discipline, and a refusal to quit quietly.",
      "There is a small, irritating voice in your head insisting you are meant for more, and you keep trying to drown it with distractions.",
      "He did not need everyone to believe in him; he just needed to stop treating their doubt like a court ruling.",
      "Under a flickering streetlight, with nothing in his pockets, he finally understood the difference between being lost and being early.",
      "She walked back into the room like a plot twist, calm, unbothered, and uninterested in asking for permission this time.",
      "The truth is not that you are unlucky; the truth is that you keep throwing your time into fires that do not keep you warm.",
      "He looked at the fine print and realized the real cost was not in dollars but in years he could never get back.",
      "You keep begging for a sign, ignoring the fact that waking up miserable twelve days in a row already counts as one.",
      "She was not hunting for a hero; she was clearing space to become her own, which people mislabeled as disobedience.",
      "He did not slam the door; he simply stopped explaining himself and let his absence complete the sentence.",
      "You train your fingers on these keys to prove your focus still belongs to you in a world designed to steal it.",
      "There is a strange kind of calm when you finally admit you are responsible for what happens next.",
      "He smiled in the middle of chaos, not because he trusted the odds, but because he trusted his capacity to adapt.",
      "She did not need revenge; living well on her own terms was a louder ending than any speech.",
      "They told you to be realistic; what they meant was, do not grow beyond the version of you that makes us comfortable.",
      "You step onto the stage with shaking hands, realizing bravery never promised to feel pretty, only necessary.",
      "He looked around and knew he had outgrown conversations that worship problems and execute nothing.",
      "She closed the app, muted the noise, and remembered what her own thoughts sounded like without an audience.",
      "You talk about destiny like a schedule instead of something you quietly build when nobody is impressed.",
      "He came back to the workbench, the notebook, the gym, the code, like a sequel everyone doubted but needed.",
      "She sharpened her boundaries, and the wrong people called her difficult while the right ones called her clear.",
      "The sky did not swell with music, but he chose differently that day, and that was the real cinematic moment.",
      "You are not the worst thing you have done; you are the pattern you are rehearsing today on purpose.",
      "He realized that staying silent during disrespect was the same as volunteering for it.",
      "She laughed when they said she had changed, because remaining the same had always been the nightmare.",
      "You do not need another speech; you need to stop breaking the promises you whisper to yourself at midnight.",
      "He chose steady effort over constant spectacle, and five years later people called him lucky.",
      "She accepted that closure is often self-authored, and moved on without waiting for a permission slip.",
      "You are not lost; you are simply too aware to keep pretending the old map fits.",
      "He exhaled, rolled his shoulders back, and treated the next attempt like the one that finally lands.",
      "She stopped begging for a seat at hostile tables and built a room where people like her walked in like they belonged."
    ];

    // ----------------- LOFI AUDIO PLAYER -----------------
    const tracks = Array.from({ length: 10 }, (_, i) => `lofi${i + 1}.mp3`);
    let currentTrackIndex = Math.floor(Math.random() * tracks.length);

    const nowPlayingEl = document.getElementById("nowPlaying");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const nextTrackBtn = document.getElementById("nextTrackBtn");

    let bgAudio = new Audio(tracks[currentTrackIndex]);
    bgAudio.volume = 0.25;
    bgAudio.loop = true;

    function updateNowPlayingLabel() {
      nowPlayingEl.textContent = tracks[currentTrackIndex];
    }

    function playAudioWithUnlock() {
      bgAudio.play().catch(() => {
        document.body.addEventListener(
          "click",
          () => {
            bgAudio.play().catch(() => {});
          },
          { once: true }
        );
      });
    }

    function loadTrack(index) {
      if (bgAudio) {
        bgAudio.pause();
      }
      currentTrackIndex = (index + tracks.length) % tracks.length;
      bgAudio = new Audio(tracks[currentTrackIndex]);
      bgAudio.volume = 0.25;
      bgAudio.loop = true;
      updateNowPlayingLabel();
      playAudioWithUnlock();
    }

    playPauseBtn.addEventListener("click", () => {
      if (bgAudio.paused) {
        bgAudio.play().catch(() => {});
        playPauseBtn.textContent = "Pause";
      } else {
        bgAudio.pause();
        playPauseBtn.textContent = "Play";
      }
    });

    nextTrackBtn.addEventListener("click", () => {
      loadTrack(currentTrackIndex + 1);
      playPauseBtn.textContent = "Pause";
    });

    // init audio
    updateNowPlayingLabel();
    playAudioWithUnlock();

    // ----------------- TYPING GAME LOGIC -----------------
    const promptElement = document.getElementById("prompt");
    const inputElement = document.getElementById("input");
    const newPromptBtn = document.getElementById("newPromptBtn");
    const restartBtn = document.getElementById("restartBtn");

    const wpmElement = document.getElementById("wpm");
    const accuracyElement = document.getElementById("accuracy");
    const errorsElement = document.getElementById("errors");
    const charsElement = document.getElementById("chars");

    let currentPrompt = "";
    let startTime = null;
    let finished = false;

    function setNewPrompt() {
      currentPrompt =
        typingPrompts[Math.floor(Math.random() * typingPrompts.length)];
      promptElement.innerHTML = currentPrompt
        .split("")
        .map((ch) => `<span>${ch}</span>`)
        .join("");

      inputElement.value = "";
      inputElement.disabled = false;
      inputElement.focus();

      startTime = null;
      finished = false;

      wpmElement.textContent = "-";
      accuracyElement.textContent = "-";
      errorsElement.textContent = "-";
      charsElement.textContent = currentPrompt.length.toString();
    }

    function handleInput() {
      if (finished) return;

      const input = inputElement.value;
      const spans = promptElement.querySelectorAll("span");

      if (!startTime && input.length > 0) {
        startTime = new Date();
      }

      let correct = 0;
      let errors = 0;

      spans.forEach((span, i) => {
        const expected = span.textContent;
        const typed = input[i];

        if (typed == null) {
          span.classList.remove("correct", "incorrect");
        } else if (typed === expected) {
          span.classList.add("correct");
          span.classList.remove("incorrect");
          correct++;
        } else {
          span.classList.add("incorrect");
          span.classList.remove("correct");
          errors++;
        }
      });

      if (input.length >= currentPrompt.length) {
        finishTest(correct, errors, input.length);
      }
    }

    function finishTest(correct, errors, typedLength) {
      finished = true;
      inputElement.disabled = true;

      if (!startTime) {
        wpmElement.textContent = "0";
        accuracyElement.textContent = "0%";
        errorsElement.textContent = String(errors);
        return;
      }

      const endTime = new Date();
      const minutes = (endTime - startTime) / 1000 / 60 || 1 / 60;
      const wordCount = currentPrompt.trim().split(/\s+/).length;
      const wpm = Math.max(0, Math.round(wordCount / minutes));
      const accuracy = Math.max(
        0,
        Math.round((correct / Math.max(typedLength, 1)) * 100)
      );

      wpmElement.textContent = String(wpm);
      accuracyElement.textContent = accuracy + "%";
      errorsElement.textContent = String(errors);
    }

    inputElement.addEventListener("input", handleInput);

    newPromptBtn.addEventListener("click", () => {
      setNewPrompt();
    });

    restartBtn.addEventListener("click", () => {
      if (!currentPrompt) return;
      inputElement.disabled = false;
      inputElement.value = "";
      inputElement.focus();
      startTime = null;
      finished = false;

      const spans = promptElement.querySelectorAll("span");
      spans.forEach((span) =>
        span.classList.remove("correct", "incorrect")
      );

      wpmElement.textContent = "-";
      accuracyElement.textContent = "-";
      errorsElement.textContent = "-";
    });

    // Initialize first prompt
    setNewPrompt();
  </script>
</body>
</html>
